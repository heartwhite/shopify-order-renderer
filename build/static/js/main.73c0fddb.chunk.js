(this.webpackJsonpapp1=this.webpackJsonpapp1||[]).push([[0],{17:function(e,t,a){e.exports=a(42)},22:function(e,t,a){},23:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(15),l=a.n(o),i=(a(22),a(23),a(2)),c=a.n(i),s=a(5),u=a(4),d=a(3),m=a(16),p=a.n(m),f=function(e){var t=e.v,a=e.getCsvFile,n=e.download,o=!1;return"Same Day Delivery"!==t.name&&"Tip"!==t.name&&"Shipping"!==t.name||(o=!0),r.a.createElement("div",{key:t.name,className:"vendor-card ".concat(o&&"own")},r.a.createElement("div",null,r.a.createElement("label",null,t.name," :"),r.a.createElement("p",null," ",t.amountToBePaid)),t.soldItems&&r.a.createElement("div",null,n.name===t.name?r.a.createElement("button",null,r.a.createElement("a",{href:n.url},"Download Csv")):r.a.createElement("button",{onClick:function(){return a(t.soldItems,t.name)}}," ",r.a.createElement("p",null,t.name,".csv"))))},v=function(){var e=Object(n.useState)(null),t=Object(d.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)({vendors:[]}),i=Object(d.a)(l,2),m=i[0],v=i[1],h=Object(n.useState)(!1),g=Object(d.a)(h,2),y=g[0],E=g[1],b=Object(n.useState)(null),T=Object(d.a)(b,2),P=T[0],S=T[1];function w(e){var t=new Date(e),a=t.getDate(),n=t.getMonth()+1,r=t.getFullYear();return a<10&&(a="0"+a),n<10&&(n="0"+n),t=n+"/"+a+"/"+r}function N(e){return Number(e.toFixed(2))}function A(e){var t=0,a=0,n=0,r=function(r){var o=0;e[r].soldItems.forEach((function(t){var a=t.price*t.quantity;if(e[r].itemCount+=t.quantity,o+=a,e[r].grossSale+=a,"Tip Jar"!==r&&"Tip"!==r&&w(t.orderPlacedAt)<w("2020-06-08 00:00:01 +0200")){var n=function(e,t){return Number((e/100*t).toFixed(2))}(a,15);t.rood15=n,e[r].amountToBePaid+=a-n,e[r].rood15+=n}else e[r].amountToBePaid+=a})),e[r].grossSale=N(e[r].grossSale),e[r].amountToBePaid=N(e[r].amountToBePaid),e[r].rood15=N(e[r].rood15),e[r].soldItems.push({name:"TOTAL",price:N(o),rood15:e[r].rood15}),"Tip Jar"!==r&&(a+=e[r].amountToBePaid),t+=e[r].grossSale,n+=e[r].rood15};for(var o in e)r(o);return e.totalGross=N(t),e.totalToPay=N(a),e.totalRood15=N(n),e}function O(e,t){return j.apply(this,arguments)}function j(){return(j=Object(s.a)(c.a.mark((function e(t,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("http://localhost:3000/upload",{dataArray:t,name:a});case 2:"it is ok"===e.sent.data&&E({name:a,url:"http://localhost:3000/".concat(a,".csv")});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(s.a)(c.a.mark((function e(t){var a,n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=w(t[0].soldItems[0].orderPlacedAt),r=w(t[0].soldItems[0].orderPlacedAt),o=t.map((function(e){return e.soldItems&&"Tip Jar"!==e.name?(e.soldItems.forEach((function(e){e.quantity&&(w(e.orderPlacedAt)>r?r=w(e.orderPlacedAt):w(e.orderPlacedAt)<n&&(n=w(e.orderPlacedAt)))})),a="".concat(n.replace(/\//g,""),"-").concat(r.replace(/\//g,""),"generalCSV"),{name:e.name,period:"".concat(n,"-").concat(r),"Total Quantity":e.itemCount,"Gross Sale":e.grossSale,Payout:e.amountToBePaid,Roodkappje:e.rood15}):(console.log("this is a problem with general csv preparing function"),null)})),S(a),O(o,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",{className:"dropField"},r.a.createElement("div",{className:"upload-section"},r.a.createElement("h4",null,"Upload orders CSV"),r.a.createElement("div",{className:"upload-input"},r.a.createElement("input",{type:"file",accept:".csv",id:"fileInput",onChange:function(e){o(e.target.files[0])}}),r.a.createElement("button",{onClick:function(){if(a){var e=new FileReader;e.readAsBinaryString(a),e.onload=function(e){var t=function(e){var t={},a={name:"Shipping",grossSale:0,rood15:0,amountToBePaid:0,soldItems:[]},n=null;return e.forEach((function(e){var r=e.orderNr,o={name:e.vendor,soldItems:[],itemCount:0,grossSale:0,amountToBePaid:0,rood15:0};"fulfilled"===e.fulfillment&&"0"!==e.shipping&&a.soldItems.push({orderNr:r,price:Number(e.shipping),quantity:1,orderPlacedAt:e.orderDate}),"fulfilled"===e.itemFulfillment?(e.fulfillment&&(n=e.fulfillDate),e.vendor&&(t[e.vendor]||("Tip Jar"===e.vendor?t[e.vendor]=Object(u.a)(Object(u.a)({},o),{},{name:"Same Day Delivery"}):t[e.vendor]=o),t[e.vendor].soldItems.push({name:e.name.replace("@#@","-"),price:e.price,quantity:e.quantity,orderNr:e.orderNr,orderPlacedAt:w(e.orderDate),orderFulfilledAt:w(n)}))):"Tip"===e.name&&(t.Tip||(t.Tip=Object(u.a)(Object(u.a)({},o),{},{name:"Tip"})),t.Tip.soldItems.push({name:e.name.replace("@#@","-"),price:e.price,quantity:e.quantity,orderNr:e.orderNr,orderPlacedAt:w(e.orderDate)}))})),t.Shipping=a,t}(function(e){return e.map((function(e){return{name:e["Lineitem name"],price:Number(e["Lineitem price"]),quantity:Number(e["Lineitem quantity"]),fulfillDate:e["Fulfilled at"],orderDate:e["Created at"],paidDate:e["Paid at"],orderNr:e.Name,vendor:e.Vendor,itemFulfillment:e["Lineitem fulfillment status"],fulfillment:e["Fulfillment Status"],shipping:e.Shipping}}))}(function(e){for(var t=e.split("\n"),a=[],n=t[0].split(","),r=1;r<t.length;r++){for(var o={},l=t[r].split(","),i=0;i<n.length;i++)o[n[i]]=l[i];a.push(o)}return a}(e.target.result)));t=A(t);var a=[];for(var n in t)"totalGross"!==n&&"totalToPay"!==n&&"totalRood15"!==n&&a.push(t[n]);t={vendors:a,totalGross:t.totalGross,totalToPay:t.totalToPay,totalRood15:t.totalRood15},v(t)}}}},"Show Results"),m.vendors[0]&&(y.name!==P?r.a.createElement("button",{onClick:function(){return function(e){return C.apply(this,arguments)}(m.vendors)}},"Prepare Vendors CSV"):r.a.createElement("a",{href:y.url},"Download Csv")))),r.a.createElement("div",{className:"vendor-card-container"},m.vendors[0]&&m.vendors.map((function(e){return r.a.createElement(f,{key:e.name,v:e,getCsvFile:O,download:y})}))),r.a.createElement("div",{className:"csv"}))};var h=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},"Shopify Orders Export Renderer"),r.a.createElement(v,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.73c0fddb.chunk.js.map