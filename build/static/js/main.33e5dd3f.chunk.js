(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{17:function(e,t,a){e.exports=a(42)},22:function(e,t,a){},23:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(16),l=a.n(o),i=(a(22),a(23),a(3)),c=a.n(i),s=a(5),d=a(4),u=a(2),m=a(6),p=a.n(m),f=function(e){var t=e.v,a=e.getCsvFile,r=e.download,o=!1;return"Same Day Delivery"!==t.name&&"Tip"!==t.name&&"Shipping"!==t.name||(o=!0),n.a.createElement("div",{key:t.name,className:"vendor-card ".concat(o&&"own")},n.a.createElement("div",null,n.a.createElement("label",null,t.name," :"),n.a.createElement("p",null," ",t.amountToBePaid)),t.soldItems&&n.a.createElement("div",null,r.name===t.name?n.a.createElement("button",null,n.a.createElement("a",{href:r.url},"Download Csv")):n.a.createElement("button",{onClick:function(){return a(t.soldItems,t.name)}}," ",n.a.createElement("p",null,t.name,".csv"))))},v=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),a=t[0],o=t[1],l=Object(r.useState)({vendors:[]}),i=Object(u.a)(l,2),m=i[0],v=i[1],h=Object(r.useState)(!1),g=Object(u.a)(h,2),y=g[0],b=g[1],P=Object(r.useState)(null),E=Object(u.a)(P,2),T=E[0],S=E[1];function O(e){var t=new Date(e),a=t.getDate(),r=t.getMonth()+1,n=t.getFullYear();return a<10&&(a="0"+a),r<10&&(r="0"+r),t=r+"/"+a+"/"+n}function j(e){return Number(e.toFixed(2))}function N(e){var t=0,a=0,r=0,n=function(n){var o=0;e[n].soldItems.forEach((function(t){var a=t.price*t.quantity;if(e[n].itemCount+=t.quantity,o+=a,e[n].grossSale+=a,"Tip Jar"!==n&&"Tip"!==n&&O(t.orderPlacedAt)<O("2020-06-08 00:00:01 +0200")){var r=function(e,t){return Number((e/100*t).toFixed(2))}(a,15);t.rood15=r,e[n].amountToBePaid+=a-r,e[n].rood15+=r}else e[n].amountToBePaid+=a})),e[n].grossSale=j(e[n].grossSale),e[n].amountToBePaid=j(e[n].amountToBePaid),e[n].rood15=j(e[n].rood15),e[n].soldItems.push({name:"TOTAL",price:j(o),rood15:e[n].rood15}),"Tip Jar"!==n&&(a+=e[n].amountToBePaid),t+=e[n].grossSale,r+=e[n].rood15};for(var o in e)n(o);return e.totalGross=j(t),e.totalToPay=j(a),e.totalRood15=j(r),e}function A(e,t){return w.apply(this,arguments)}function w(){return(w=Object(s.a)(c.a.mark((function e(t,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("https://shopify-order-export-renderer.herokuapp.com/upload",{dataArray:t,name:a});case 2:"it is ok"===e.sent.data&&b({name:a,url:"https://shopify-order-export-renderer.herokuapp.com/".concat(a,".csv")});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(s.a)(c.a.mark((function e(t){var a,r,n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=O(t[0].soldItems[0].orderPlacedAt),n=O(t[0].soldItems[0].orderPlacedAt),o=t.map((function(e){return e.soldItems&&"Tip Jar"!==e.name?(e.soldItems.forEach((function(e){e.quantity&&(O(e.orderPlacedAt)>n?n=O(e.orderPlacedAt):O(e.orderPlacedAt)<r&&(r=O(e.orderPlacedAt)))})),a="".concat(r.replace(/\//g,""),"-").concat(n.replace(/\//g,""),"generalCSV"),{name:e.name,period:"".concat(r,"-").concat(n),"Total Quantity":e.itemCount,"Gross Sale":e.grossSale,Payout:e.amountToBePaid,Roodkappje:e.rood15}):(console.log("this is a problem with general csv preparing function"),null)})),S(a),A(o,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.a.createElement("div",{className:"dropField"},n.a.createElement("div",{className:"upload-section"},n.a.createElement("h4",null,"Upload orders CSV"),n.a.createElement("div",{className:"upload-input"},n.a.createElement("input",{type:"file",accept:".csv",id:"fileInput",onChange:function(e){o(e.target.files[0])}}),n.a.createElement("button",{onClick:function(){if(a){var e=new FileReader;e.readAsBinaryString(a),e.onload=function(e){var t=function(e){var t={},a={name:"Shipping",grossSale:0,rood15:0,amountToBePaid:0,soldItems:[]},r=null;return e.forEach((function(e){var n=e.orderNr,o={name:e.vendor,soldItems:[],itemCount:0,grossSale:0,amountToBePaid:0,rood15:0};"fulfilled"===e.fulfillment&&"0"!==e.shipping&&a.soldItems.push({orderNr:n,price:Number(e.shipping),quantity:1,orderPlacedAt:e.orderDate}),"fulfilled"===e.itemFulfillment?(e.fulfillment&&(r=e.fulfillDate),e.vendor&&(t[e.vendor]||("Tip Jar"===e.vendor?t[e.vendor]=Object(d.a)(Object(d.a)({},o),{},{name:"Same Day Delivery"}):t[e.vendor]=o),t[e.vendor].soldItems.push({name:e.name.replace("@#@","-"),price:e.price,quantity:e.quantity,orderNr:e.orderNr,orderPlacedAt:O(e.orderDate),orderFulfilledAt:O(r)}))):"Tip"===e.name&&(t.Tip||(t.Tip=Object(d.a)(Object(d.a)({},o),{},{name:"Tip"})),t.Tip.soldItems.push({name:e.name.replace("@#@","-"),price:e.price,quantity:e.quantity,orderNr:e.orderNr,orderPlacedAt:O(e.orderDate)}))})),t.Shipping=a,t}(function(e){return e.map((function(e){return{name:e["Lineitem name"],price:Number(e["Lineitem price"]),quantity:Number(e["Lineitem quantity"]),fulfillDate:e["Fulfilled at"],orderDate:e["Created at"],paidDate:e["Paid at"],orderNr:e.Name,vendor:e.Vendor,itemFulfillment:e["Lineitem fulfillment status"],fulfillment:e["Fulfillment Status"],shipping:e.Shipping}}))}(function(e){for(var t=e.split("\n"),a=[],r=t[0].split(","),n=1;n<t.length;n++){var o={},l=t[n].split(",");if(l.length===r.length){for(var i=0;i<r.length;i++)o[r[i]]=l[i];a.push(o)}else if(l.length>45&l.length<r.length){for(var c=0;c<r.length;c++)o[r[c]]=l[c];for(l=t[++n].split(",");l.length<24;){if(23===l.length){o.Vendor=l[5];break}l=t[++n].split(",")}a.push(o)}}return a}(e.target.result)));t=N(t);var a=[];for(var r in t)"totalGross"!==r&&"totalToPay"!==r&&"totalRood15"!==r&&a.push(t[r]);t={vendors:a,totalGross:t.totalGross,totalToPay:t.totalToPay,totalRood15:t.totalRood15},v(t)}}}},"Show Results"),m.vendors[0]&&(y.name!==T?n.a.createElement("button",{onClick:function(){return function(e){return k.apply(this,arguments)}(m.vendors)}},"Prepare Vendors CSV"):n.a.createElement("a",{href:y.url},"Download Csv")))),n.a.createElement("div",{className:"vendor-card-container"},m.vendors[0]&&m.vendors.map((function(e){return n.a.createElement(f,{key:e.name,v:e,getCsvFile:A,download:y})}))))},h=function(){var e=Object(r.useState)(),t=Object(u.a)(e,2),a=t[0],o=t[1],l=Object(r.useState)(),i=Object(u.a)(l,2),m=i[0],v=i[1],h=Object(r.useState)(!1),g=Object(u.a)(h,2),y=g[0],b=g[1],P=Object(r.useState)([]),E=Object(u.a)(P,2),T=E[0],S=E[1],O=Object(r.useState)({vendors:[]}),j=Object(u.a)(O,2),N=j[0],A=j[1],w=Object(r.useState)(!1),k=Object(u.a)(w,2),I=k[0],C=k[1],D=Object(r.useState)(null),B=Object(u.a)(D,2),F=B[0],q=B[1],x={startDate:a,endDate:m};function R(){return(R=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("http://localhost:8000/orders",x);case 2:t=e.sent,S(t.data),b(!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){var t=new Date(e),a=t.getDate(),r=t.getMonth()+1,n=t.getFullYear();return a<10&&(a="0"+a),r<10&&(r="0"+r),t=r+"-"+a+"-"+n}function J(e){return Number(e.toFixed(2))}function V(e){var t=0,a=0,r=0,n=function(n){var o=0;e[n].soldItems.forEach((function(t){var a=t.price*t.quantity;if(e[n].itemCount+=t.quantity,o+=a,e[n].grossSale+=a,t.orderPlacedAt&&(t.orderPlacedAt=t.orderPlacedAt.slice(0,10)),"Tip Jar"!==n&&"Tip"!==n&&G(t.orderPlacedAt)<G("2020-06-08 00:00:01 +0200")){var r=function(e,t){return Number((e/100*t).toFixed(2))}(a,15);t.rood15=r,e[n].amountToBePaid+=a-r,e[n].rood15+=r}else e[n].amountToBePaid+=a})),e[n].grossSale=J(e[n].grossSale),e[n].amountToBePaid=J(e[n].amountToBePaid),e[n].rood15=J(e[n].rood15),e[n].soldItems.push({name:"TOTAL",price:J(o),rood15:e[n].rood15}),"Tip Jar"!==n&&(a+=e[n].amountToBePaid),t+=e[n].grossSale,r+=e[n].rood15};for(var o in e)n(o);return e.totalGross=J(t),e.totalToPay=J(a),e.totalRood15=J(r),e}function _(e,t){return L.apply(this,arguments)}function L(){return(L=Object(s.a)(c.a.mark((function e(t,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("https://shopify-order-export-renderer.herokuapp.com/upload",{dataArray:t,name:a});case 2:"it is ok"===e.sent.data&&C({name:a,url:"https://shopify-order-export-renderer.herokuapp.com/".concat(a,".csv")});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(s.a)(c.a.mark((function e(t){var a,r,n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=G(t[0].soldItems[0].orderPlacedAt),n=G(t[0].soldItems[0].orderPlacedAt),o=t.map((function(e){return e.soldItems&&"Tip Jar"!==e.name?(e.soldItems.forEach((function(e){e.quantity&&(G(e.orderPlacedAt)>n?n=G(e.orderPlacedAt):G(e.orderPlacedAt)<r&&(r=G(e.orderPlacedAt)))})),a="".concat(r.replace(/\//g,""),"-").concat(n.replace(/\//g,""),"generalCSV"),{name:e.name,period:"".concat(r,"-").concat(n),"Total Quantity":e.itemCount,"Gross Sale":e.grossSale,Payout:e.amountToBePaid,Roodkappje:e.rood15}):(console.log("this is a problem with general csv preparing function"),null)})),q(a),_(o,a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return n.a.createElement("div",null,n.a.createElement("div",{className:"dropField"},n.a.createElement("div",{className:"upload-section"},n.a.createElement("h4",null,"Orders API... Pick Date Range"),n.a.createElement("div",{className:"date-input"},n.a.createElement("section",null,n.a.createElement("label",{htmlFor:"start-date"},"Start Date "),n.a.createElement("input",{type:"datetime-local",placeholder:"--/--/2020, 00:00",id:"start-date",onChange:function(e){o(e.target.value),b(!0)}})),n.a.createElement("section",null,n.a.createElement("label",{htmlFor:"end-date"},"End Date "),n.a.createElement("input",{type:"datetime-local",placeholder:"--/--/2020, 23:59",id:"end-date",onChange:function(e){v(e.target.value),b(!0)}})),N.vendors[0]&&(I.name!==F?n.a.createElement("button",{onClick:function(){return function(e){return M.apply(this,arguments)}(N.vendors)}},"Prepare Vendors CSV"):n.a.createElement("a",{href:I.url},"Download Csv"))),n.a.createElement("div",{className:"upload-input"},!T[0]||y?n.a.createElement("button",{onClick:function(){return R.apply(this,arguments)}},"SUBMIT"):n.a.createElement("button",{onClick:function(){if(T[0]){var e=function(e){var t={},a={name:"Shipping",grossSale:0,rood15:0,amountToBePaid:0,soldItems:[]};return e.forEach((function(e){var r=e.orderNr,n={name:e.vendor,soldItems:[],itemCount:0,grossSale:0,amountToBePaid:0,rood15:0};"fulfilled"===e.orderFullfillment&&e.shipping&&a.soldItems.push({orderNr:r,price:Number(e.shipping),quantity:1,orderPlacedAt:e.orderDate}),"fulfilled"===e.fulfillment_status?e.vendor&&(t[e.vendor]||("Tip Jar"===e.vendor?t[e.vendor]=Object(d.a)(Object(d.a)({},n),{},{name:"Same Day Delivery"}):t[e.vendor]=n),t[e.vendor].soldItems.push({name:e.name,price:e.price,quantity:e.quantity,orderNr:e.orderNr,orderPlacedAt:e.orderPlacedAt})):"Tip"===e.name&&(t.Tip||(t.Tip=Object(d.a)(Object(d.a)({},n),{},{name:"Tip"})),t.Tip.soldItems.push({name:e.name,price:e.price,quantity:e.quantity,orderNr:e.orderNr}))})),t.Shipping=a,t}(function(e){var t=[];return e.forEach((function(e){e.line_items[0].shipping=e.shipping_lines[0].discounted_price,e.line_items.forEach((function(a){a.orderNr=e.name,a.orderPlacedAt=e.created_at,a.orderFullfillment=e.fulfillment_status,t.push(a)}))})),t}(T));e=V(e);var t=[];for(var a in e)"totalGross"!==a&&"totalToPay"!==a&&"totalRood15"!==a&&t.push(e[a]);e={vendors:t,totalGross:e.totalGross,totalToPay:e.totalToPay,totalRood15:e.totalRood15},A(e)}}},"Show Results"))),n.a.createElement("div",{className:"vendor-card-container"},N.vendors[0]&&N.vendors.map((function(e){return n.a.createElement(f,{key:e.name,v:e,getCsvFile:_,download:I})})))))};var g=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},"Shopify Orders Renderer"),n.a.createElement(v,null),n.a.createElement(h,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.33e5dd3f.chunk.js.map